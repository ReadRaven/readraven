{% load staticfiles %}
<!DOCTYPE html>
<html>
  <head>
    <title>The House of Usher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link media="screen" rel="stylesheet" href="{% static 'css/bootstrap.css' %}" />
    <link media="screen" rel="stylesheet" href="{% static 'css/usher.css' %}" />
    <script type="text/javascript" src="https://js.stripe.com/v1/"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    Stripe.setPublishableKey('pk_test_XPlbtK7un2pVFbRfLUjBPS3U');

    var stripeResponseHandler = function(status, response) {
        var $form = $('#signup-form');

        if (response.error) {
            $form.find('.payment-errors').text(response.error.message);
            $form.find('button').prop('disabled', false);
        } else {
            var token = response.id;
            $form.append($('<input type="hidden" name="stripeToken" />').val(token));
            $form.get(0).submit();
        }
    };
    jQuery(function($) {
        $('#signup-form').submit(function(e) {
            var $form = $(this);

            // Disable the submit button to prevent repeated clicks
            $form.find('button').prop('disabled', true);
            Stripe.createToken($form, stripeResponseHandler);

            // Prevent the form from submitting with the default action
            return false;
        });
    });
  </script>
  </head>
  <body id="index">
    <div class="page-wrapper">
      <div class="container-fluid">
        <div class="row">
          <div class="span6">
            <h1>almost done...</h1>
            <p>Our squirrels are importing your Google Reader feeds as we speak.</p>
            <hr>
            <p><b>What am I paying for?</b></p>
            <p>We believe in building great products for a fair price. We will
            do everything in our power to keep Readraven around for as long as
            feeds exist. We will never sell your data. We promise to put you
            first.</p>
          </div>
          <div class="span6">
          <h1>&nbsp;</h1>
          <h1>&nbsp;</h1>
          <form action="/usher/sign_up" method="post" id="signup-form">
            {% csrf_token %}
            <span class="payment-errors"></span>

            <div class="form-row">
              <label>
                <span>Card Number</span>
                <input type="text" size="20" data-stripe="number"/>
              </label>
            </div>

            <div class="form-row">
              <label>
                <span>CVC</span>
                <input type="text" size="4" data-stripe="cvc"/>
              </label>
            </div>

            <div class="form-row">
              <label>
                <span>Expiration (MM/YYYY)</span>
                <input type="text" size="2" data-stripe="exp-month"/>
              </label>
              <input type="text" size="4" data-stripe="exp-year"/>
            </div>

            <button type="submit" class="btn btn-primary">Sign up for Readraven</button>
          </form>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="{% static 'js/bootstrap.js' %}"></script>
</html>
